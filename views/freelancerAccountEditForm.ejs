<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>UserEditForm</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="/my-css/style.css">
    <link href="/home/css/style.css" rel="stylesheet" />
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/material-design-iconic-font@2.2.0/dist/css/material-design-iconic-font.min.css">
    <link rel="stylesheet" href="/freelancer-nav-css/style.css">

    <style>
        .freelancerAccountEditfooter {
            width: 80.5%;
            float: right;

        }

        .clientProfileEditForm-main {
            /* border: 1px solid red; */
            width: 85%;
            float: right;
        }
    </style>
</head>

<body>
    <!-- navber -->
    <%-include("./layouts/FreelancerDashboardNavber") %>
        <div class="clientProfileEditForm-main">
            <div style="margin-top: 100px;" class="container mt-6">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2>Update Your Profile</h2>
                    <a href="/freelancerAccount" class="btn btn-dark">Back to Profile</a>
                </div>

                <% if (typeof error_msg !=='undefined' && error_msg.length> 0) { %>
                    <div class="alert alert-danger" role="alert">
                        <%= error_msg %>
                    </div>
                    <% } %>

                        <% if (typeof success_msg !=='undefined' && success_msg.length> 0) { %>
                            <div class="alert alert-success" role="alert">
                                <%= success_msg %>
                            </div>
                            <% } %>

                                <form action="/freelancerAccountEdit/<%= user._id %>" method="POST" class="row g-3"
                                    enctype="multipart/form-data">
                                    <!-- Name and Email -->
                                    <div class="col-md-6">
                                        <label for="name" class="form-label">Full Name *</label>
                                        <input type="text" class="form-control" id="name" name="name"
                                            value="<%= user.name %>" required />
                                    </div>

                                    <div class="col-md-6">
                                        <label for="email" class="form-label">Email Address *</label>
                                        <input type="email" class="form-control" id="email" name="email"
                                            value="<%= user.email %>" required />
                                    </div>

                                    <!-- Contact -->
                                    <div class="col-md-6">
                                        <label for="phone" class="form-label">Phone Number *</label>
                                        <input type="text" class="form-control" id="phone" name="phone"
                                            value="<%= user.phone %>" required />
                                    </div>

                                    <!-- Location Fields -->
                                    <div class="col-md-6">
                                        <label for="city" class="form-label">City</label>
                                        <input type="text" class="form-control" id="city" name="city"
                                            value="<%= user.city || '' %>" />
                                    </div>

                                    <div class="col-md-6">
                                        <label for="state" class="form-label">State</label>
                                        <input type="text" class="form-control" id="state" name="state"
                                            value="<%= user.state || '' %>" />
                                    </div>

                                    <div class="col-md-6">
                                        <label for="country" class="form-label">Country</label>
                                        <input type="text" class="form-control" id="country" name="country"
                                            value="<%= user.country || '' %>" />
                                    </div>

                                    <!-- Profile Picture Upload -->
                                    <div class="col-md-6">
                                        <label for="profilePic" class="form-label">Profile Picture</label>
                                        <input type="file" class="form-control" id="profilePic" name="profilePic"
                                            accept="image/*" />
                                        <% if (user.profilePic) { %>
                                            <div class="mt-2">
                                                <img src="<%= user.profilePic %>" alt="Profile Picture"
                                                    class="img-thumbnail" style="max-width: 120px;" />
                                            </div>
                                            <% } %>
                                    </div>

                                    <!-- Hidden Redirect -->
                                    <input type="hidden" name="redirectTo" value="<%= redirectTo %>" />

                                    <!-- Submit -->
                                    <div class="col-12" style="text-align: center;">
                                        <button type="submit" class="btn btn-primary w-10">
                                            Update Profile
                                        </button>
                                    </div>
                                </form>
            </div>
        </div>
        
        <div class="freelancerAccountEditfooter">
            <%-include("./layouts/footer") %>
        </div>
        <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const sidebar = document.getElementById('sidebar');
                const mainContent = document.getElementById('mainContent');
                const sidebarToggle = document.getElementById('sidebarToggle');
                const mobileToggle = document.getElementById('mobileToggle');
                const toggleIcon = sidebarToggle.querySelector('i');

                // Desktop sidebar toggle
                sidebarToggle.addEventListener('click', function () {
                    sidebar.classList.toggle('collapsed');
                    mainContent.classList.toggle('expanded');

                    if (sidebar.classList.contains('collapsed')) {
                        toggleIcon.className = 'fas fa-chevron-right';
                    } else {
                        toggleIcon.className = 'fas fa-chevron-left';
                    }
                });

                // Mobile sidebar toggle
                mobileToggle.addEventListener('click', function () {
                    sidebar.classList.toggle('show');
                });

                // Close sidebar when clicking outside on mobile
                document.addEventListener('click', function (event) {
                    if (window.innerWidth <= 768) {
                        const isClickInsideSidebar = sidebar.contains(event.target);
                        const isClickOnMobileToggle = mobileToggle.contains(event.target);

                        if (!isClickInsideSidebar && !isClickOnMobileToggle) {
                            sidebar.classList.remove('show');
                        }
                    }
                });

                // Handle window resize
                window.addEventListener('resize', function () {
                    if (window.innerWidth > 768) {
                        sidebar.classList.remove('show');
                    }
                });

                // Add active class to current nav item
                const currentPath = window.location.pathname;
                const navLinks = document.querySelectorAll('.nav-link');

                navLinks.forEach(link => {
                    if (link.getAttribute('href') === currentPath) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });

                // Smooth hover effects
                const navItems = document.querySelectorAll('.nav-item');
                navItems.forEach(item => {
                    item.addEventListener('mouseenter', function () {
                        this.style.transform = 'translateX(5px)';
                    });

                    item.addEventListener('mouseleave', function () {
                        this.style.transform = 'translateX(0)';
                    });
                });

                // Top Navbar Dropdown Functionality
                const notificationsBtn = document.getElementById('notificationsBtn');
                const messagesBtn = document.getElementById('messagesBtn');
                const userMenuBtn = document.getElementById('userMenuBtn');
                const notificationsDropdown = document.getElementById('notificationsDropdown');
                const messagesDropdown = document.getElementById('messagesDropdown');
                const userDropdown = document.getElementById('userDropdown');

                // Notifications dropdown
                notificationsBtn.addEventListener('click', function (e) {
                    e.stopPropagation();
                    notificationsDropdown.classList.toggle('show');
                    messagesDropdown.classList.remove('show');
                    userDropdown.classList.remove('show');
                });

                // Messages dropdown
                messagesBtn.addEventListener('click', function (e) {
                    e.stopPropagation();
                    messagesDropdown.classList.toggle('show');
                    notificationsDropdown.classList.remove('show');
                    userDropdown.classList.remove('show');
                });

                // User menu dropdown
                userMenuBtn.addEventListener('click', function (e) {
                    e.stopPropagation();
                    userDropdown.classList.toggle('show');
                    notificationsDropdown.classList.remove('show');
                    messagesDropdown.classList.remove('show');
                });

                // Close dropdowns when clicking outside
                document.addEventListener('click', function (event) {
                    if (!notificationsBtn.contains(event.target) && !notificationsDropdown.contains(event.target)) {
                        notificationsDropdown.classList.remove('show');
                    }
                    if (!messagesBtn.contains(event.target) && !messagesDropdown.contains(event.target)) {
                        messagesDropdown.classList.remove('show');
                    }
                    if (!userMenuBtn.contains(event.target) && !userDropdown.contains(event.target)) {
                        userDropdown.classList.remove('show');
                    }
                });

                // Search functionality
                const searchInput = document.querySelector('.search-input');
                const searchBtn = document.querySelector('.search-btn');

                searchBtn.addEventListener('click', function () {
                    const searchTerm = searchInput.value.trim();
                    if (searchTerm) {
                        // Redirect to search page or perform search
                        window.location.href = `/freelancer/jobs?search=${encodeURIComponent(searchTerm)}`;
                    }
                });

                searchInput.addEventListener('keypress', function (e) {
                    if (e.key === 'Enter') {
                        searchBtn.click();
                    }
                });

                // Mark all notifications as read
                const markAllReadBtn = document.querySelector('.mark-all-read');
                if (markAllReadBtn) {
                    markAllReadBtn.addEventListener('click', function (e) {
                        e.preventDefault();
                        const unreadItems = document.querySelectorAll('.notification-item.unread');
                        unreadItems.forEach(item => {
                            item.classList.remove('unread');
                        });

                        // Update notification badge
                        const notificationBadge = notificationsBtn.querySelector('.notification-badge');
                        if (notificationBadge) {
                            notificationBadge.textContent = '0';
                            notificationBadge.style.display = 'none';
                        }
                    });
                }

                // Add hover effects to dropdown items
                const dropdownItems = document.querySelectorAll('.dropdown-item');
                dropdownItems.forEach(item => {
                    item.addEventListener('mouseenter', function () {
                        this.style.transform = 'translateX(5px)';
                    });

                    item.addEventListener('mouseleave', function () {
                        this.style.transform = 'translateX(0)';
                    });
                });

                // Add smooth animations to notification items
                const notificationItems = document.querySelectorAll('.notification-item, .message-item');
                notificationItems.forEach((item, index) => {
                    item.style.animationDelay = `${index * 0.1}s`;
                    item.classList.add('fade-in');
                });
            });
        </script>
</body>

</html>